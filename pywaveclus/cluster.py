#!/usr/bin/env python

import logging, os, shutil, subprocess, sys, tempfile

import numpy as np

def get_os():
    if sys.platform.startswith('linux'):
        return 'linux'
    elif sys.platform == 'win32':
        return 'win'
    elif sys.platform == 'darwin':
        return 'mac'
    else:
        # 'cygwin', 'os2', 'os2emx', 'riscos', 'atheos'
        raise ValueError("Unknown operating system: %s" % sys.platform)

def cluster(features, method = 'spc', tmp = '/tmp', **kwargs):
    """
    """
    assert(method in ['spc','klustakwik'])
    if method == 'spc':
        return spc_cluster(features, tmp, **kwargs)
    elif method == 'klustakwik':
        return klustakwik_cluster(features, tmp, **kwargs)
    else:
        raise ValueError("Unknown clustering method: %s" % method)

def spc_cluster(features, tmp = '/tmp', **kwargs):
    """
    """
    tempdir = tempfile.mkdtemp(dir=tmp, suffix='_pywaveclus')
    
    datafile = "/".join((tempdir, "features"))
    mintemp = kwargs.get('mintemp', 0)
    maxtemp = kwargs.get('maxtemp', 0.201)
    tempstep = kwargs.get('tempstep', 0.01)
    outfile = "/".join((tempdir, "clusters"))
    swcycles = kwargs.get('swcycles', 100)
    knn = kwargs.get('knn', 11)
    tempthresh = kwargs.get('tempthresh', int(len(features) * 0.25))
    
    runfile = """
            NumberOfPoints: %i
            DataFile: %s
            Dimentions: %i
            MinTemp: %f
            MaxTemp: %f
            TempStep: %f
            OutFile: %s
            SWCycles: %i
            KNearestNeighbours: %i
            MSTree|
            DirectedGrowth|
            SaveSuscept|
            WriteLables|
            WriteCorFile~
    """ % (features.shape[0], datafile, features.shape[1], mintemp, maxtemp, tempstep,
            outfile, swcycles, knn)
    
    # write runfile
    runfilename = 'spc.run'
    rf = open("/".join((tempdir, runfilename)),"w")
    rf.write(runfile)
    rf.close()
    
    # write datafile
    np.savetxt(datafile, features)
    
    # copy correct executable
    exefile = 'bin/spc_' + get_os()
    shutil.copy2(exefile, tempdir)
    exefile = 'spc_' + get_os()
    
    # run executable
    olddir = os.getcwd()
    os.chdir(tempdir)
    retcode = subprocess.call(['./spc_' + get_os(), runfilename])
    os.chdir(olddir)
    print "Clustering returned:", retcode
    
    # read output
    cdata = np.loadtxt(outfile+'.dg_01.lab')
    tree = np.loadtxt(outfile+'.dg_01')
    
    # clean up
    shutil.rmtree(tempdir)
    
    # find good 'temperature' for clustering
    dt = np.diff(tree,axis=0)[:,4:8] # only consider 5 clusters, this is based on WaveClus
    # ct = int(len(features) * 0.25) # set clustering threshold, only count temps with > spikes?
    logging.debug("Cluster temperature threshold: %i" % tempthresh)
    temp = len(np.where(np.max(dt,1) > tempthresh)[0])
    if temp == 0 and tree[0,6] < tempthresh:
        temp += 1 # based on WaveClus... all seems arbitrary :-/
    logging.debug("Cluster temperature: %i" % temp)
    
    clusters = []
    for i in xrange(5):
        clusters.append(np.where(cdata[temp,2:] == i)[0])
    unmatched = np.setdiff1d(range(len(features)), [c for cluster in clusters for c in cluster])
    clusters = [unmatched,] + clusters
    
    return clusters, cdata, tree

def klustakwik_cluster(features, tmp = '/tmp', **kwargs):
    """
    """
    tempdir = tempfile.mkdtemp(dir=tmp, suffix='_pywaveclus')
    raise NotImplemented
    shutil.rmtree(tempdir)

def test_cluster(plot=False):
    """
    """
    fakefeatures = np.array([\
    [1.385663688065069676e+00,2.425804097235943479e-01,3.372250816884983515e-01],
    [2.051226595771882710e+00,3.414861333760421669e-02,2.570383474431807702e-01],
    [2.223450508445299789e+00,1.525007823047345723e-01,-6.997588191487646991e-02],
    [1.991989949523290226e+00,3.490973380939199622e-01,6.543478574962136030e-02],
    [2.025337832943053584e+00,-2.158581252452376753e-01,1.479535288554074679e-01],
    [2.086312948027282399e+00,-5.343007472711849143e-03,2.910426379231665361e-01],
    [2.134989024957355319e+00,-2.900221993359910003e-02,6.789054087470312859e-02],
    [2.066817282695963875e+00,-3.641152978269209927e-03,9.636122386867852774e-02],
    [1.299429127478482826e+00,2.649014058244287262e-01,2.460709650927714598e-01],
    [2.289670611403215261e+00,9.734962633078197980e-02,1.972805930648829920e-01],
    [1.393591483945485709e+00,1.598560006653046983e-01,4.266657077592498903e-01],
    [2.018195746047172001e+00,-4.016557636370473444e-02,4.780817909962829099e-02],
    [2.282157642358999095e+00,-7.002505643732982732e-02,3.282305671206202369e-02],
    [1.386014143421143263e+00,9.352187008673931712e-02,5.461734579029855485e-01],
    [2.189763518334698400e+00,-8.597949547702940856e-03,8.627629186392786476e-02],
    [2.024426705777202073e+00,5.177176078463081865e-02,1.369670190460003933e-01],
    [2.033099220666882534e+00,1.500477854490376295e-01,7.603875477504436209e-02],
    [1.870367457730037097e+00,4.864489687406789442e-02,2.065365159692576780e-01],
    [1.375841951867943225e+00,3.150456391046566607e-01,3.464725414457621722e-01],
    [2.024185152837284729e+00,-1.257300328349134355e-01,3.769485259326332827e-01],
    [2.210038801311741796e+00,-8.404622741912855244e-02,1.536138407807245421e-01],
    [1.451148970157973839e+00,2.939170375410319891e-01,2.791347234741687333e-01],
    [2.021809587149729026e+00,-1.012684914451313090e-01,1.784393254345308100e-01],
    [2.214549254427752523e+00,9.701845929297499282e-02,1.271277073025194604e-01],
    [2.033108624895168859e+00,1.067718680840551992e-01,1.001027701384072099e-01],
    [2.045039987261246583e+00,3.426509867578805130e-02,-1.945825456462782488e-02],
    [1.474698964280329871e+00,1.685126563717725678e-01,2.238524646566483478e-01],
    [2.284573716843578239e+00,-5.480654540642591194e-03,8.290365748336200880e-02],
    [1.482078378924962303e+00,2.567821680938332518e-01,3.551562539470544122e-01],
    [1.585491792941766231e+00,1.890833326845273443e-01,4.808360781754748570e-01]])
    
    realfeatures = np.array([\
    [-7.707149837590581906e-04,-1.127284224243334070e-03,1.668924001753915225e-04,-2.650882063468444782e-05,-1.240532211554537263e-03,-6.614717040530577801e-04,-2.326908766163138232e-04,-2.814186959814390606e-04,-5.740626337492927026e-04,-4.493728155366462644e-04],
    [3.359068162035277767e-03,-1.066804064605380046e-03,-4.239027843733176888e-04,-7.767249668358569385e-04,-9.205713497160417352e-04,-5.517189134342005436e-04,2.551873800396488312e-03,-2.386502415887215218e-04,-1.166097373595955007e-03,4.883818331183833886e-04],
    [-3.298612488793981881e-04,1.044600564537284643e-04,3.553555475843428479e-04,2.809198171326603350e-04,1.049441797235512304e-04,6.281411486250982603e-04,-7.593710368579036692e-04,8.276039599784107805e-04,7.240637905736972690e-04,5.104521201661162046e-04],
    [1.126313256255290956e-03,-6.215632669894150921e-06,-9.309634620532431437e-04,-1.127991781063684713e-03,-2.321482643517715661e-04,3.816167573296323150e-04,2.030867220042144230e-03,8.646570626640353230e-04,5.041399967048251383e-04,2.996294371011921421e-04],
    [2.717230860038665451e-03,-3.562856042129468955e-05,-7.822228617837510833e-04,-1.029108939439762026e-03,-1.674357998504962051e-04,3.667642117386797585e-04,1.117043907121605334e-03,9.971203411577368204e-04,5.914992057176315108e-04,1.623438978157163174e-03],
    [-8.150661332883825340e-05,2.148333241284803164e-04,2.471670214178820217e-04,5.257192805950515468e-04,-2.497797809525307742e-04,-5.291853930669094749e-04,3.313049228521523196e-04,-7.634293896893341717e-05,4.282307578565867153e-04,8.207953066710339763e-04],
    [-3.604915322682781197e-04,2.203398118248669395e-04,-6.354953590593873927e-04,-3.367589034801619311e-04,-1.585075766123169609e-05,1.090107782176056878e-04,-5.236368960426699386e-05,1.628364947086794281e-04,1.093501817279331429e-03,-4.818056339978331543e-04],
    [-9.922696178288410891e-04,1.585832596475154335e-03,-2.440415264791659985e-03,-2.116895463791131082e-03,1.758636212424386728e-03,1.806686481828807377e-03,-1.203298288299026251e-04,1.453152518028330174e-03,1.484156310771470554e-03,5.304570896491446821e-04],
    [4.691176852966836078e-03,1.942050571987016415e-03,7.730548325595154851e-04,7.257043494403783018e-04,1.701419750530193788e-03,9.052269303264573333e-04,3.540804873933182158e-03,8.788224806037052937e-04,1.422833948332689153e-03,1.689574035509831948e-03],
    [4.380393613352077790e-04,1.126349035806825183e-03,2.915702718027837325e-04,2.056315248450178257e-04,1.356165616339880279e-03,1.062042022296540936e-03,6.342875394074378587e-04,7.634546038966889478e-04,4.532569909491472549e-04,1.008922780284495424e-03],
    [3.344142225618407672e-03,7.288190319513007795e-04,3.644475640644780708e-04,2.913791437516446108e-05,5.770819236573177446e-04,5.394386648969936313e-04,2.644553796964363435e-03,8.168193442950210824e-04,5.427629022017913755e-04,1.248782481437891870e-03],
    [-6.806094501332503235e-04,-7.443091229053482982e-04,6.290064869422816235e-04,4.303728844537360989e-04,-2.356869757099003054e-04,5.556144586317033718e-05,-4.483474200707104028e-04,-4.785299709986852099e-05,-1.821556844672352028e-03,-1.339651483311451866e-04],
    [6.279660828142521849e-04,7.772050775588172210e-04,7.023371137697175318e-04,4.753294085932440664e-04,1.395475423892167431e-03,1.832061549331558386e-03,1.742399787118935079e-03,1.297441462229574367e-03,-2.251276993593333720e-04,-6.620277853210312230e-04],
    [2.641391038326317692e-03,2.689276975225570973e-04,-1.023407672190138453e-03,-8.648246110849331291e-04,5.444492026879403429e-04,9.203413190131249201e-04,1.945161183095622586e-03,1.217028798523184848e-03,-5.416261387131347501e-04,2.185112743451086623e-03],
    [1.408090187712856189e-04,9.352213577858733799e-04,7.539064343555682652e-04,4.721907476085483008e-04,7.518608521524014054e-04,-1.955466864548702970e-04,5.260815319715835036e-04,-9.767256015836959550e-04,1.018329319544490153e-03,-2.225993928154743062e-03],
    [3.479300688546246335e-03,1.305573269228000764e-03,-4.293681100583863000e-04,-6.348192813143122394e-04,1.107783742933316417e-03,7.895032824453998522e-04,2.894625523039832428e-03,9.043290283903360292e-04,1.055593948432299997e-03,1.247239919987042957e-03],
    [2.696431746087475656e-04,1.700290807644880687e-04,5.835346923492193243e-04,1.021556824475930306e-03,-1.757749571706860691e-04,-4.700326656193833975e-04,6.979764494975822763e-04,-4.423609563113230312e-04,9.625498966146110507e-04,-3.076016999534576736e-04],
    [-6.292020783917378008e-04,1.545179467901069926e-03,1.446768320639424811e-04,-4.566709672140033369e-05,1.049763151196907423e-03,6.611298899087930236e-04,-5.151143527162738465e-05,7.157241612591959314e-04,1.931580384039506592e-03,4.848546775282512795e-04],
    [2.896889251751927612e-03,6.660769018065904870e-04,5.289426268885832720e-04,3.920975995723948219e-04,1.169259632637788477e-03,1.373036844128413007e-03,2.330724004874223584e-03,1.169351844261207933e-03,-5.995790884857571737e-04,5.438080738458913243e-04],
    [3.875879198927137392e-03,-3.548123027464495499e-05,4.180689806744205855e-04,2.991667591930684934e-05,-3.047508560823981752e-04,9.115897945204895231e-04,2.956086906147408540e-03,1.816288311089523386e-03,1.292548864338331511e-03,2.116400461341960346e-03],
    [2.997126361835580292e-03,-1.285490941275191932e-04,-6.944212471559814154e-04,-7.248846179866419697e-04,2.649185612633651166e-05,4.405628871962535571e-04,2.961134302908042214e-03,7.209655868222657540e-04,-4.752931868430750333e-04,9.853977318942264835e-04],
    [-9.677678839636376590e-04,8.787667931289991179e-04,2.302352546270567107e-04,3.835449438100294647e-04,1.107744868321783533e-03,1.627273849178949424e-03,-3.586910916063248056e-04,1.480371163866636263e-03,1.051440600328659020e-03,-4.749916642475622612e-05],
    [-1.118493930388234038e-03,-6.399233977326174898e-04,1.430976751486630989e-03,1.602205809474381397e-03,-5.461379746736696062e-04,-7.163535792018150400e-05,-3.071333112329219369e-04,6.145122253261823284e-05,-4.357520731521552027e-04,7.882009882281248970e-05],
    [-1.425795366834477175e-03,5.745572175157890801e-04,-2.265207328919454212e-04,1.668844748608274819e-04,2.100327045519743497e-04,-1.201380917164743750e-04,-9.923520295661819157e-04,2.252871694873475911e-04,4.319573512543717917e-04,6.927222933693040008e-04],
    [3.525167173481051630e-03,6.377065215047147744e-04,4.696939013031081197e-05,6.069298393868373154e-05,6.897454540974261826e-04,7.209434838294244809e-04,2.961830054888849040e-03,8.966120833603577608e-04,-1.162693865693575869e-04,9.562376218965516978e-04],
    [8.057806419935554035e-04,7.272053504251218365e-04,1.896507945739456767e-03,1.772684067150079399e-03,8.281269902918451551e-04,3.880917333977906532e-04,1.318276281558689294e-03,1.376110048537750909e-04,2.829913079491066597e-04,8.362599251984521431e-04],
    [2.882686442368772011e-03,-9.100566147534755988e-05,1.114719091855452712e-05,-1.632295248971730138e-04,-6.014580811304901572e-04,-8.356528440061674603e-04,2.279745014471840515e-03,-3.266593528498946790e-04,5.374308900042119126e-04,1.046994639650265574e-03],
    [-1.209874263924509089e-03,1.427518972349961848e-03,-9.628074716717013566e-04,-8.800563044451007941e-04,9.475423834210662749e-04,5.206986896644961874e-04,-6.149972545621612205e-04,8.732517300057184365e-04,1.557973187362848150e-03,1.655239832942634976e-03],
    [2.573610084829691062e-03,5.384888079688766437e-04,-6.578088844379824471e-04,-8.257118229474852454e-04,-1.261272995958761232e-04,-8.779506428108625445e-04,1.130362022903166116e-03,-6.398531422785416105e-04,1.066728397950825798e-03,8.082884948510073088e-05],
    [1.001460109884096204e-03,8.473313304701691291e-04,1.208406584340982343e-04,-4.994855924422827650e-04,2.066110903993737414e-04,-5.806791550441088600e-05,1.484726829533246362e-03,1.639503986194513585e-04,2.013244553267997793e-03,2.269192347235124505e-04],
    [3.402390675356069174e-03,-2.921223740871656152e-04,1.064507572763468074e-03,8.848133714193495139e-04,1.108832632882689287e-04,4.914162087573646382e-04,2.602612335570679558e-03,4.584074771458859841e-04,-8.766017836424049459e-04,4.113739099920629650e-04],
    [-7.971323325845343323e-04,1.002975298517169017e-03,1.395490675497372546e-03,1.089317283536497686e-03,1.031180718637786462e-03,1.014629057183851586e-03,-2.444078361947127896e-04,7.925149689130011775e-04,8.964466738039160529e-04,6.627619475515097146e-05],
    [-9.687797294864206401e-05,2.325595974738363120e-03,3.076424224805570013e-04,3.454632077333680599e-04,2.667430171495351054e-03,1.951211136300227836e-03,-4.726710242914922811e-05,1.123346029205187641e-03,1.236169948272297561e-03,1.002695235060515222e-04],
    [-2.570424999369204104e-05,6.713843818228713020e-04,3.897109579036711320e-04,2.018254394253522657e-04,3.655893396079093797e-04,4.537325651864359947e-04,1.091290605435063597e-03,5.860512260717512479e-04,1.507584048719205717e-03,2.377463707998216439e-04],
    [2.799672014615530585e-03,4.253280688364485763e-04,3.936643495434837881e-04,-1.132539829252026645e-04,8.322541372684830836e-04,1.270040889876378806e-03,1.861306913411112443e-03,1.353649381104948769e-03,-3.734309849559196213e-04,1.226207075644648523e-03],
    [-4.579243214945863394e-04,2.120880054345948107e-04,-3.990276996286268286e-04,-2.951411813995938717e-04,4.627385661512007091e-04,1.244256479677208985e-03,-2.340187459763082669e-04,1.447411322987175860e-03,1.657124082316871309e-04,1.004382981593613527e-03],
    [7.715443722529773422e-04,1.709606848482099484e-03,-1.621113433038911134e-03,-1.567777717184765801e-03,1.600864869404259759e-03,7.159562518304218729e-04,1.045412442056629703e-03,1.952034227760131399e-04,1.698029400001148295e-03,2.655777349957953140e-04],
    [2.608174918769068200e-03,4.876863529486269010e-04,1.295378493127326107e-03,1.119908396480585313e-03,6.774597471319791613e-04,1.300004612250558198e-03,2.582371477030176617e-03,1.650938531536240168e-03,3.488465416448462576e-04,1.882996468405601261e-03],
    [3.872924000486114432e-03,1.597867021177214707e-04,-3.843993100648796321e-05,-3.718815577953105638e-05,1.180302499311800202e-04,1.836270908430368237e-04,3.276377865118443918e-03,4.413513963718596880e-04,2.976712429885123575e-05,9.020883245018569176e-04],
    [-7.946781860075249719e-04,3.128644822555593169e-04,7.097081583401508619e-04,9.886249285170308539e-04,-5.859430697833123181e-05,-7.119178772571895875e-04,-1.269341698959924880e-03,-8.739217483985553103e-04,7.883390591890362563e-04,-1.132285731677268271e-03],
    [-8.389639896110753477e-04,2.052402022517723029e-04,1.777116705987035676e-04,2.270531605964312910e-04,4.966987401685666898e-04,6.020056078333826596e-04,-3.412804259443626923e-04,3.548516639547580299e-04,-1.011945223672134026e-04,-1.496010439086854099e-04],
    [-1.126628890710392773e-03,1.237841655996242294e-04,-1.026553730275459389e-03,-8.168329199683501719e-04,3.243192085025123437e-04,9.465542222156578256e-04,-1.534772562110187988e-04,1.230509864014592150e-03,-1.621691074243598386e-04,8.511585801560237786e-04],
    [-9.183473527232592594e-04,1.623844859583429656e-04,3.628515556015858155e-05,2.545754915326233544e-04,1.818705512044755009e-04,5.285469791510863467e-04,-5.171492810091687931e-04,6.018961368494765056e-04,2.559445079251988363e-04,-1.532484777417302435e-04],
    [6.383953074801331949e-04,1.296131506738041781e-03,-1.081446859444054566e-03,-1.425282616799832935e-03,9.794802983234102665e-04,5.459000568117795523e-04,8.694280699872436458e-04,2.897744353934769354e-04,1.695422596388724027e-03,-9.500099923235553892e-04],
    [-5.847519776111851459e-04,3.684556742199280514e-04,-5.413671691078686139e-04,-4.654359454566312708e-04,-1.672753310576074483e-04,1.649627184418006771e-04,-5.235818958935858393e-04,8.386177405021740623e-04,1.327280234013483197e-03,1.230432760341214305e-03],
    [3.753098130663532362e-03,5.398523969404238430e-04,4.781270846250806092e-04,1.804812731307490245e-04,6.457872391217427946e-04,8.110095927184783702e-04,3.912046480229772367e-03,8.939389937356762581e-04,3.635611266518680679e-04,8.445037598248674414e-04],
    [3.404606221565523866e-03,3.993757422322478760e-04,-6.725403793194345136e-05,-1.813109647780516555e-05,5.821018342762195215e-04,1.524165466364697146e-03,3.066295547655961944e-03,2.039345462846754980e-03,2.585063583665000845e-04,2.208621519673382039e-03],
    [3.057844443918064301e-03,1.705081736366970873e-03,-3.424025330199724037e-04,-5.498231584425678333e-04,1.260557129557667152e-03,9.225774179998161295e-04,2.413021615474836030e-03,1.219074949843986129e-03,2.241832721182448421e-03,1.842380309134715021e-03],
    [3.019084777598575377e-03,9.630898833790651906e-04,7.269310928508417036e-04,9.325818475070472152e-04,5.000739995125696828e-04,-2.476671842796642267e-05,2.514913719515672868e-03,2.486623129720484226e-04,9.341179372012783227e-04,1.097706643243519372e-03],
    [-1.333644127869044061e-03,4.511314041215904814e-04,9.655437073139201297e-04,8.603345821026607033e-04,-3.963608902982377404e-05,-6.181788726997239445e-04,-4.398982285880121616e-04,-4.599852670987803708e-04,6.838549060768502833e-04,-1.614158045799177579e-04],
    [7.665263712087831260e-04,3.835402464175558792e-04,8.757871767314651243e-04,9.684256147679112456e-04,7.075070889899281795e-04,9.436526384987750215e-04,1.687776276101498588e-04,9.171038050417534794e-04,-2.451102416432853945e-04,7.505650892350923184e-04],
    [3.389960352705070033e-03,2.571777809227053339e-04,-8.930336097916450212e-04,-8.953810756011207394e-04,4.268373521893034433e-04,7.512425898485749869e-04,2.762859797082735207e-03,9.988421237244202514e-04,-1.741689764155608894e-04,1.250067354524826485e-03],
    [-2.069379770872040343e-04,-1.493902490000374175e-04,-1.835434033307905470e-04,6.246926966027185576e-05,-4.069015230651590429e-04,-3.033478581126004890e-04,4.406927361838143233e-05,-1.796565877924957092e-04,5.157910193083593093e-04,-7.642363166161473143e-04],
    [3.418698456137442884e-03,2.050851732234519782e-03,4.036713728794751044e-04,4.608293645141242362e-04,1.936040575348502981e-03,9.852987160692717062e-04,2.202882787925958610e-03,4.915569210751864803e-04,1.484254755930758700e-03,1.711273217790094741e-04],
    [4.684695542661137494e-04,1.443413857434753785e-03,5.878606844917174832e-04,4.302548714847798800e-04,1.291594301012000774e-03,6.390831081661753777e-04,7.836588408087509765e-04,4.828152808854243265e-05,1.437875067598352180e-03,-1.452989807057096083e-03],
    [3.589251659489640315e-03,2.034944555395880393e-04,-1.111553285342918281e-03,-1.077011204800272992e-03,3.540464735188941846e-04,5.777169602459558120e-04,2.698349788107139938e-03,6.721147795680688670e-04,-3.349082167312292355e-04,7.559480097266810424e-04],
    [-2.817290173769125571e-04,1.616701492208758029e-03,-4.518380333678981048e-04,-1.051094879622111778e-04,1.433486429049151550e-03,1.021881022926676924e-03,8.202611928301551628e-05,7.272362546864636788e-04,2.031530668174597824e-03,1.301438799682531216e-04],
    [-1.083313854448581361e-03,1.851799390292350903e-04,-9.906495768922916629e-04,-7.437663771277694229e-04,7.302376190016736032e-04,1.369802677773718051e-03,-1.103117604440483806e-03,1.415563531884795863e-03,-3.902771633888247856e-04,1.623575689912240549e-03],
    [2.563055676903216919e-03,4.684393118439600704e-04,-1.042464802844802032e-03,-1.057698495495295980e-03,1.446720276676448814e-04,5.345444356400577430e-04,1.030804619792619536e-03,1.394636374672362676e-03,9.972839696722297313e-04,2.841131383396439374e-03],
    [-1.831368634841888849e-04,8.094218350030293408e-04,-2.436480570366582831e-04,-4.644835900047966106e-04,8.014532051288874399e-04,4.831505864356522436e-05,-1.424266834829224075e-04,-5.002387035094647307e-04,5.475092546155952691e-04,-9.602113642791717000e-04],
    [-1.051524359600717121e-03,6.009775038837497640e-04,6.898900113928489817e-04,4.896557080078621635e-04,5.178729004784196448e-04,6.414354387810458809e-04,-6.956336878681189904e-04,5.662241850412624150e-04,9.643688007526639988e-04,-5.472859051632625966e-04],
    [-1.184184037937727413e-03,9.525064047406499486e-04,1.328122391142725699e-05,2.471711612272432758e-04,7.470537578190392016e-04,3.024584656248359123e-04,-3.261973144471677611e-04,-2.229486051614138601e-05,1.137986062109957921e-03,-5.690635647243168661e-04],
    [2.975087413066717940e-03,5.442587945535355475e-05,5.155570485866075399e-04,8.303097967696890670e-04,5.476476397480200316e-04,1.487928083079048756e-03,2.298761056819522471e-03,1.908535660491267848e-03,-8.345310815109275747e-04,2.029798356488604020e-03],
    [-6.386338575789175971e-04,-3.814696956702173444e-04,-2.239070795702721337e-04,1.904211629093501251e-04,-4.534348315421076413e-04,-1.728484970909065528e-05,-4.978804617129667116e-04,2.369082145704628269e-04,-8.963275627958601933e-05,-2.041737949089584387e-04],
    [3.785454543626574474e-03,4.051269992921639469e-04,-1.249843792319760196e-03,-1.199778387838867661e-03,4.704791347394655086e-04,1.419423299651231081e-03,3.318655427305467268e-03,1.968764510091485995e-03,8.068819636371815131e-04,2.115325288549655021e-03],
    [2.954160204743650799e-03,1.022813126338508903e-03,6.012990622555719445e-05,5.450993281135784282e-05,8.217354510491617576e-04,5.381516379346853876e-04,1.738930138066944672e-03,7.001134696977915489e-04,1.043458209300220964e-03,1.251075110415901829e-03],
    [-9.756768375811946965e-04,-3.366899877987137440e-04,-4.951484904265498311e-05,3.376456844918287743e-05,2.395675832073536316e-04,4.275985954325995557e-04,-8.450318020264920883e-04,1.301026320879354278e-04,-1.066517820356895161e-03,-2.213902282456037658e-05],
    [8.644093999070111625e-04,-4.864773448830018478e-04,2.507703646428377747e-04,6.354713977081681304e-04,-6.663253116579922206e-04,-8.742763353973531226e-04,8.549438987609900460e-04,-8.068496844311703756e-04,3.581302730343479670e-04,1.882016154345510684e-04],
    [3.515656747093513172e-03,5.999576989141469641e-04,-5.797652129865859313e-04,-1.383712284655038739e-04,1.199816475496049686e-03,1.927456097148013510e-03,1.552583561896392220e-03,1.806850807359041853e-03,9.225797423820229933e-05,1.071407253024021138e-03],
    [-1.628695934465281946e-03,5.152246023788104598e-04,8.164574736443475176e-04,9.805665314196237905e-04,5.323259554754054433e-04,1.166082654508791491e-03,-4.603484093434556884e-04,1.467541829537896214e-03,6.276679252727693659e-04,1.119781649417791276e-03],
    [1.546296938545540069e-03,9.919646057612195242e-04,-1.062113392713642367e-03,-1.061469282666441466e-03,9.785172977185357338e-04,-2.071725296061982123e-04,1.841373840610729127e-03,-9.356967432488246493e-04,3.967877608709093084e-04,-9.269901429712437170e-04],
    [2.407259844177196163e-03,9.495588899721176803e-04,3.106575386437396822e-04,3.958562174663790372e-04,1.159053887953564359e-03,1.127078611911109347e-03,1.302552138912066752e-03,1.045891248189602298e-03,4.893566579455730595e-04,1.036062313087304267e-03],
    [-1.045500528174716191e-03,8.640156682222652684e-04,1.665926697367901626e-04,1.161873672760277778e-04,5.972395670114520648e-04,5.286847218275499572e-04,-4.334417010731523440e-04,5.519723539468473833e-04,1.290773848604680500e-03,1.260516623048237939e-04],
    [2.060286717677437199e-05,1.390285208050884899e-03,1.146540320476477966e-04,1.072485545154536966e-04,1.640490291323912784e-03,1.354034377500755752e-03,2.196476200161486176e-04,9.146576415993486631e-04,6.500062645859160668e-04,3.722623564041515200e-04],
    [9.930561363018398376e-06,1.779833057413101379e-03,-3.299352588829353302e-04,-3.896263758288622393e-04,1.994012939719182545e-03,1.308187441422870630e-03,-9.820230891765854950e-05,5.759485669759238473e-04,1.039924219974706215e-03,-3.963650982513848694e-04],
    [2.351566944969759806e-03,-4.908646952999424400e-04,5.098760407736725600e-04,8.054639382636460000e-04,-1.780722751224509564e-04,2.666819691563847598e-04,1.053227396642386149e-03,3.130031080209013717e-04,-6.652174304295185902e-04,5.304510916316042485e-04],
    [2.833889526404345053e-03,-3.832344414715354187e-04,8.127813052467469017e-05,1.512770282180587306e-04,-6.477803205337449811e-04,1.710322157875113387e-04,2.465822567659831360e-03,8.142585742901436476e-04,8.231739967976961026e-04,1.001096870027348706e-03],
    [-8.311284067753305299e-04,-7.663024429152198638e-04,-1.789303800860740201e-04,-2.519692426967064269e-04,-8.456713596447206762e-04,-9.659837544667224519e-05,-2.217744698282177206e-04,3.844660873956762281e-04,3.373707600026210345e-04,3.088507754852584729e-04],
    [2.544420102843144085e-03,1.023525664039669995e-03,-9.687949884205352335e-04,-1.213899378683253646e-03,1.049846123761338746e-03,7.426794290995124281e-04,1.269765833156633050e-03,5.427649779080973231e-04,5.358277225863884068e-04,5.367613169950054058e-04],
    [-7.517042192619739045e-05,1.031856151034235515e-03,-1.348250018943143768e-03,-1.493769016775273271e-03,1.068059551925961640e-03,1.254913591729834481e-03,1.514006795145551323e-04,1.184662603431924609e-03,1.361729263903948065e-03,5.922588234001818254e-04],
    [-2.597417755504554727e-04,3.973065537383113285e-04,1.665479801543387039e-04,6.470929939647433477e-05,3.177784745184819437e-07,-2.955849585369353118e-04,-4.418750258335558284e-04,-2.631918070765994753e-04,1.299020455318445613e-03,-9.914679320539974852e-05],
    [1.753938971862333690e-03,3.941444591387899482e-04,4.509193906706472914e-04,4.921830318968536348e-04,8.481948987983865514e-04,1.356603547453052571e-03,7.705605793360196902e-04,1.520919770923270884e-03,-7.007514349330763162e-04,1.637201273815049648e-03],
    [4.186330910401151427e-03,1.510999302443179508e-03,-1.125852916006860526e-03,-1.135775890996840436e-03,1.374592756008854479e-03,1.373639092225832289e-03,3.890611179493799147e-03,1.420502396719972981e-03,1.611311248356420318e-03,1.163664872748254977e-03],
    [4.016591237042967631e-03,-2.927972714077134919e-04,8.992046310696833454e-05,2.170470487503943776e-05,4.589459789766913702e-04,1.469981388970788934e-03,3.790328369443971002e-03,1.728518091497662380e-03,-1.631892252697029772e-03,1.859923509319589196e-03],
    [8.522448782381978174e-04,1.814547200802701845e-03,1.503972870043463177e-04,3.073800279715227231e-04,1.740318901363430973e-03,9.771496364082792301e-04,8.242053795360751488e-04,3.547304144838726663e-04,1.779600112134788973e-03,-5.153330389571197370e-04],
    [-2.621725199620688403e-05,6.348381717383128975e-04,-6.158919796540872653e-04,-3.852800321574145596e-05,4.808923744473072161e-04,2.348693389157548801e-04,-5.703406489200732931e-04,4.702819956139526287e-04,5.629896341358580410e-04,1.501930669204506325e-03],
    [4.157917761436851628e-03,-1.222688444378487553e-03,5.469084053898138698e-04,2.658774185933867077e-04,-1.562188826426883469e-03,-1.538179068240591542e-03,3.539864211504295186e-03,-1.046986301580326434e-03,-5.908355796338435849e-04,1.375543720589495957e-05],
    [2.002228331377948079e-03,1.264245102296006514e-03,1.137306315716117566e-03,8.670296814001274667e-04,1.444809825940864337e-03,1.855899852362629960e-03,5.863047045664594855e-04,1.742986288962079496e-03,1.277042600759027095e-03,8.898756445094699232e-04],
    [2.181933773048368424e-03,5.032301004683703224e-05,-1.569481515697419621e-03,-1.603503095827813613e-03,-2.242403921360491175e-04,-1.372586623409513377e-04,8.288798882484073663e-04,4.053362242060592189e-04,3.820118530276911525e-04,1.578399839070352122e-03],
    [2.520565321459480781e-03,-1.128963573830832080e-04,1.030027020571867976e-03,1.127880060801354127e-03,-1.153878984658267466e-04,7.814314026825411406e-04,1.404232683441360196e-03,1.668584964481735445e-03,-3.246911746776307299e-05,2.729802102212166171e-03],
    [2.932038694970766357e-03,1.526590252810674717e-04,-3.066743239851858998e-04,-3.439572350782094351e-04,3.698665862961645571e-04,6.741913480464552461e-04,2.244852599339537073e-03,8.708038268281539755e-04,-4.509058757136750572e-04,1.064378446549449483e-03],
    [5.135297224130682585e-04,-1.331124552564633742e-03,-2.225509689551838453e-04,-1.751642329727662469e-04,-1.696142944963394301e-03,-1.304572752898738950e-03,9.330171279039137667e-04,-6.558022451254933967e-04,-8.969096040136579251e-05,3.723715306400550385e-04],
    [6.802116301705556133e-04,-8.996615846107260442e-05,-3.417077321241502176e-04,1.237522370427904023e-04,4.592033515079288171e-04,7.620672662889952829e-05,1.029980433719713357e-03,-6.341805589048795473e-04,-1.205483656171974644e-03,-1.337094911126742456e-03],
    [4.614632231860271890e-03,5.536795160498267409e-04,3.525849748151584827e-05,2.366411905250096414e-04,8.755657637028967360e-04,8.668284495456692875e-04,3.478573265089300332e-03,5.903934434976167069e-04,-4.099694546534571533e-05,1.962426795926034740e-04],
    [3.138367844061215866e-03,-5.589442247712421126e-05,-9.843475858409766414e-04,-9.839859544701914061e-04,-1.318955573404523643e-04,-5.293664363273729954e-05,2.633161236282698017e-03,2.944920199841756492e-04,-3.984159782994129958e-04,8.869839287772170698e-04],
    [3.029391683376625889e-03,2.185820486859487073e-04,-1.463649421100667166e-03,-1.470972767008641140e-03,3.784400884621088017e-04,1.009211779359416505e-03,2.405155186313505822e-03,1.313691318220362681e-03,2.005749769752627283e-04,1.462838984165241649e-03],
    [2.688099671967130811e-04,6.486595005100200375e-04,4.854506020519711658e-04,5.060297663621523027e-04,6.607707301000988447e-04,3.532340777627261219e-04,4.240951711466913669e-04,1.598439056664359783e-04,2.443376745260535175e-04,8.822852029652860847e-05],
    [-5.200614092847171679e-04,-3.788183455357803717e-05,8.503766466267698339e-04,8.708452248733114607e-04,3.350646899026546335e-04,7.841782545669704349e-04,-8.947954022280937283e-05,7.179568173478817136e-04,-3.356813804391955004e-04,3.315017999495720202e-04],
    [3.796983594645934358e-03,-3.990501740947772732e-05,1.107341496594994477e-03,1.000587491080266560e-03,2.757657827001374230e-04,1.266332427795630738e-04,1.878432799772149957e-03,-1.605995566725766449e-04,-9.646000118959442184e-04,-3.707507621344579055e-04],
    [7.001719957343451040e-04,-9.669453079988256415e-04,-1.932495521781721836e-04,-6.150129098888918377e-04,-9.599318470216644181e-04,-5.707852980832351557e-04,4.761323470070240142e-04,-2.660424631861300470e-04,-3.438189894059255907e-04,6.143874144928215602e-04],
    [4.020633792864394709e-04,4.669969891179412652e-04,-9.483095652248112271e-04,-5.815966487483504839e-04,1.177387509269625014e-04,1.501147654842772223e-04,7.041338644250823113e-04,3.345148181990744134e-04,1.196678242485552535e-03,6.309817367972745815e-05],
    [1.425102598726193763e-03,-2.778011714319777092e-04,-2.033856323901321410e-04,-1.133093451590318988e-04,2.599584708866421452e-04,9.487885007210287644e-04,1.146121193412671241e-03,6.935964655961079917e-04,-3.204701985291433740e-04,-5.474710219340529933e-04],
    [3.126401233927159767e-03,3.147851137432904913e-04,1.046198381882378287e-03,1.416423438235041776e-03,6.273797099697574209e-04,9.210526245915952445e-04,2.096173873352086183e-03,1.037803796475507629e-03,-5.332390585608511773e-04,1.387268851527605901e-03],
    [2.716811084596806088e-03,-4.207183531898964299e-04,-4.813230351152846350e-05,8.416886872225791860e-05,7.480533070551180280e-05,1.032468451974679182e-03,1.165042513085606801e-03,1.088859165205127971e-03,-1.208525334661890031e-04,6.621377181860395355e-04],
    [1.737087885296058473e-03,7.645690786915229067e-04,-5.876533304762157758e-04,-4.934059931223000375e-04,1.187379102684447442e-03,1.733030909471079380e-03,8.897854892995670428e-04,1.634506683803006819e-03,1.113416731825298515e-04,9.646447400387080096e-04],
    [3.103069914090497271e-03,2.893865305004333336e-04,-5.136815020141477983e-04,-6.287089379321395737e-04,9.230393090550979840e-04,1.658975596812424600e-03,1.526936056158105732e-03,1.587799371957372219e-03,-3.615690090284070981e-04,1.063904575157755905e-03],
    [2.548168019556289274e-03,4.523024542288638528e-04,7.777048664035702457e-04,7.796955448763411576e-04,6.833220984254212297e-04,1.030956190729839447e-03,2.316004791022845729e-03,1.180789454132732518e-03,-2.016588624643302725e-04,9.124350688449218028e-04],
    [6.315510782490759995e-04,1.453270000879756984e-03,-1.048466494185889110e-03,-1.210643795433725143e-03,1.666598749915753665e-03,4.209076114011024760e-04,8.903444402374252348e-04,-7.222820157955695854e-04,4.001039182068582721e-04,-2.166871883415745405e-03],
    [-1.449982510038237389e-03,1.457588779015144605e-03,-1.260583738610289916e-03,-1.367686651428365579e-03,1.926882234326743109e-03,2.025911363157802906e-03,-6.069614760058283324e-04,1.356735038380945313e-03,9.888381702212599607e-04,-3.548938601114671348e-04],
    [2.353046154285512448e-03,3.447312402720632894e-04,5.718362928265016991e-04,8.384498745252837951e-04,1.899735188369174044e-04,4.578018347599349799e-05,1.163137239583501327e-03,2.143114300145699744e-04,4.986026162891228240e-04,6.382032817225024787e-04],
    [3.846758397278151383e-03,8.556423175072043369e-06,2.842342201734286049e-05,-3.247172531266943841e-04,4.431585953216848266e-04,1.039516194712251191e-03,2.907053796207699319e-03,9.492140541247783177e-04,-8.756528382009186513e-05,4.647514768171519066e-04],
    [4.026539778604416170e-03,4.617132745528968450e-04,9.582800629196075058e-04,1.297774251973086729e-03,3.751184015874001296e-04,8.281976724795783425e-04,4.135025690960358012e-03,1.135672583080872327e-03,1.076812141243050800e-03,1.230406305268280133e-03],
    [1.247992375664237633e-03,4.874276459456013903e-04,5.429898830258483118e-04,5.125242247721927078e-04,3.949106427193299585e-04,-2.751980864254848142e-04,-1.893378861081736057e-04,-4.702548914183015067e-04,-1.430467630608978058e-04,-3.764305833022494100e-04],
    [3.977152382792913977e-03,7.727560520818572585e-04,-2.265346361304934868e-03,-2.113266075861322361e-03,9.440417020032659118e-04,1.116546754077773042e-03,2.551545969029026407e-03,1.115581750105562337e-03,6.880250403723737248e-04,1.093058871694614978e-03],
    [3.650308833409151915e-05,7.538686420262720846e-04,-1.899816074790265370e-04,-3.602777320488081752e-04,9.080492788138818869e-04,6.561836789328233345e-04,6.298973454419619583e-04,3.260429313591966540e-04,5.053006518927802932e-04,3.111858883849037368e-05],
    [-3.211511776000470163e-04,3.548236253394232431e-04,-1.872227942812508962e-04,-4.576126461362371614e-04,1.695330550468780305e-04,3.672455638860056904e-04,-2.415680283671983085e-05,4.660727074561161424e-04,9.895607851399998954e-04,-1.586038556675537111e-04],
    [3.194994185273643261e-03,-9.930060206838338226e-04,1.042967685439399146e-03,9.946183169168790889e-04,-8.136075164908598920e-04,3.840612597634382252e-05,2.055328973775251335e-03,8.036969058057715463e-05,-4.435029012135542192e-04,-9.360422804386484257e-04],
    [3.085456408267513422e-03,5.548730419092046205e-04,-5.704503298491769587e-04,-2.463557450976440336e-04,1.674514232413701668e-04,-9.110986680780796979e-05,2.066937391184555262e-03,3.333272751657030642e-04,7.201023737731226124e-04,1.521281636056733954e-03],
    [3.873387945911362529e-04,1.771634207838465851e-03,-1.694169604932709320e-03,-2.085549940048487746e-03,1.928301111670339095e-03,1.065354655602511209e-03,7.971890837605080920e-04,2.594944755792612809e-04,1.066574334880591394e-03,-7.228111717706247035e-04],
    [-4.321370967849535999e-06,1.013399227843847202e-03,1.038771335590243710e-03,1.077696256126058679e-03,1.121721523100405009e-03,8.049890629871901031e-04,3.390159432882066792e-04,4.333276900371365952e-04,7.172179909193437865e-04,3.414795176789774724e-05],
    [1.658613576486185691e-04,8.015761597102676050e-04,-3.814914596975682842e-04,-6.499584953590498539e-04,8.561565835927597906e-04,1.280307581532685998e-03,9.292356965058816594e-04,1.408624028075325298e-03,8.315637597928326064e-04,8.589311764615272004e-04],
    [2.345656722996013969e-03,1.956219216880207622e-04,-6.996777610221660776e-04,-4.107992955427444064e-04,4.769067744055572895e-04,9.284739117159782930e-04,1.257240202649849989e-03,1.151818627878736399e-03,-2.197006031490456284e-04,1.374333873967117361e-03],
    [-1.233002714554774261e-03,1.018395546558518560e-03,-5.218874861641912199e-04,-5.402144538351759439e-04,4.379487054245428512e-04,-1.510115401050405475e-04,-5.357082645212906963e-04,-1.916133296757133338e-04,1.626570740304791353e-03,-5.365527096483480420e-04],
    [-6.790475703309100004e-04,1.023973371611949616e-03,-1.097038677329252847e-03,-1.121792977435476886e-03,1.292475277251099643e-03,1.589119764371234441e-03,-1.545708072829610257e-05,1.390591586952255728e-03,5.075529358574488092e-04,3.135507748833489517e-04],
    [1.795103636180719528e-04,5.531780814240190927e-04,-6.577132420053981255e-04,-8.276801826280424804e-04,8.692973968788777388e-04,2.334363299092168890e-03,9.078007700337068853e-04,2.977951384309419740e-03,5.405516967755286681e-04,2.508933169578243891e-03],
    [3.103236770774726698e-03,1.111668011166277439e-03,4.365101448741550783e-04,3.747164294899822971e-04,1.378659551061306790e-03,1.775951614256635796e-03,2.558912776821027201e-03,1.737199670214407445e-03,4.953102604279836481e-04,8.199909245582794786e-04],
    [-2.802403003908758052e-03,1.554231078094032428e-03,4.577103069668858907e-04,5.332489184921989115e-04,1.379622666697900716e-03,1.207339032298023829e-03,-2.316247724414087755e-03,1.096582520966293134e-03,1.702387075041783852e-03,7.260105120839279108e-04],
    [4.469396932988146422e-03,-6.184755929438494598e-04,-4.873095138436626668e-04,-8.591093355795227648e-04,-4.959842502277110425e-04,2.960565159054413050e-04,4.010160489069857989e-03,9.523656285971765284e-04,-6.149688893990374076e-04,1.834983148532656327e-03],
    [3.071935566266913381e-04,2.132117399117889451e-04,4.548067863910738775e-04,3.864487593549252500e-04,-5.024964314190685007e-04,-1.189370763467399034e-03,1.370784915361540146e-03,-7.886958173557546492e-04,7.474795347117832098e-04,2.141552671342428389e-04],
    [-7.530608884103153150e-04,1.253213568721198807e-03,6.087649937148874226e-04,4.010329196558023632e-04,1.420161461943808155e-03,1.910967477444928822e-03,-3.637352053446143724e-04,1.876736886218098848e-03,1.483360969973318436e-03,1.004822536541227730e-03],
    [2.319101414657530596e-03,8.669459995884886295e-04,-8.408324416245163777e-05,5.636016175579693077e-05,8.580582107103393438e-04,1.118540973766844618e-03,1.591778009598228101e-03,1.482618489973957241e-03,6.710887835414832379e-04,1.944304733900296218e-03],
    [-5.106503580184511195e-04,1.002155562611237562e-03,-1.614056943238356993e-03,-1.155306719000377940e-03,1.242042933326474108e-03,1.169298415199091943e-03,-5.265480567687854741e-04,8.808939173191996557e-04,6.888631813252653032e-04,5.259558698185746312e-04],
    [-8.444482684053988483e-04,3.653462241817335152e-04,9.943915780703175937e-04,1.230805949095869567e-03,5.358046309558311699e-04,9.840154162191448468e-04,-3.001588284712092600e-05,9.710471159423927868e-04,4.170797114003913365e-04,4.561333889680801892e-04],
    [2.137250247099193364e-03,6.219773205454741816e-04,-9.375210297584981537e-04,-9.570533121635725789e-04,2.000204750703877589e-04,-7.633676955713587960e-05,1.426358449402920876e-03,2.917627457356135497e-04,9.368064725094360804e-04,1.161048714150354332e-03],
    [2.229518975560712557e-04,8.594450732880358186e-04,-1.653328636266440709e-03,-1.242900102718336565e-03,7.005474795697656668e-04,2.883601745897228707e-04,6.248911440467382191e-04,1.289113326128028597e-04,1.240615576200528513e-03,4.043709506880733282e-04],
    [3.421554038124050619e-03,7.163070003806900655e-04,4.308763937710177586e-04,5.238324431757473022e-04,3.740220351209154036e-04,-1.015163705786366197e-04,2.550610359534596569e-03,1.609995293483221089e-06,1.017644725769893677e-03,6.021858197505686227e-04],
    [2.043328915570189180e-03,1.044196079853989146e-03,-1.251581098502595494e-03,-1.413140226196334028e-03,5.341285790222953132e-04,2.861859268199724382e-04,1.329212627668969939e-03,7.245061097650398090e-04,1.617376867941144533e-03,1.397516251010194740e-03],
    [3.278064248967473612e-03,-3.576737246019102414e-04,-1.904963673059705161e-03,-1.683271536321140566e-03,2.093465565164325849e-04,1.318026731003348051e-03,2.162258182485942825e-03,1.571372782867066229e-03,-5.223975793143128491e-04,1.576366991929669965e-03],
    [4.388772247592574900e-03,-3.602749098893264949e-05,-1.088742090895287789e-03,-1.169899322774729973e-03,2.446442358063010509e-04,7.937357729179017217e-04,3.120711889221554434e-03,9.482949994803741402e-04,3.010911360408500067e-05,1.207678095859491575e-03],
    [5.285133859053104061e-04,3.060115614001996786e-04,4.899048266060285163e-04,4.658913602390685172e-04,2.738213010703463264e-04,3.883090456734919916e-04,9.882869785653109265e-04,3.267291228957471764e-04,6.995398430601754884e-04,-2.154509993072288229e-04],
    [3.235224215947243680e-03,-1.426338355061852400e-03,1.855729808176452057e-04,4.149652243479548140e-05,-1.691861831374007847e-03,-1.156727029044045353e-03,2.102808702528154421e-03,-2.837022562036974603e-04,-5.536851034308555098e-04,1.493361156181491258e-03],
    [-5.379805118144530924e-04,3.511237363186363856e-04,9.729900610662845905e-04,1.161422499046750384e-03,1.168420174401826027e-04,-1.934434733964968459e-04,-3.027843018524835534e-04,-3.983765765123659856e-04,7.814200570447794999e-04,-1.155604971132074242e-03],
    [2.937848586811459516e-03,5.318941603300197550e-04,2.256586893669694765e-03,2.006709552482300544e-03,3.416971663222114473e-04,5.766771559599896549e-04,2.919891536102115805e-03,1.025144518258906028e-03,6.427512237451808025e-04,1.516333968244688553e-03],
    [8.737847705913676880e-04,3.342228363392958450e-04,6.186947078261257379e-05,-2.749916616614782287e-06,3.455226237040667087e-04,-6.690604412255417473e-05,6.455260997412951918e-04,-1.379353248347279365e-04,-2.285937913145561699e-04,2.053856893818046658e-04],
    [3.576837026784004947e-03,5.915387649706485259e-04,-6.051180339320220980e-04,-9.528722670946994464e-04,7.603894586136097488e-04,7.107956722368686696e-04,2.724633405707933571e-03,6.491405552019111199e-04,-5.744986409710504477e-05,4.286726235908749601e-04],
    [3.270035994791532265e-03,1.174275239725419435e-03,-1.228825167953540411e-03,-1.323969996835460241e-03,9.921596945182218491e-04,9.158545056682100127e-04,3.272734798105643439e-03,1.154174888320394889e-03,1.080596076292585604e-03,1.587414952377160958e-03],
    [3.330704001591554449e-03,-2.672382275988100227e-05,3.641865382945715275e-04,-2.299748828910251858e-04,1.000095570618110379e-04,1.515384462561259902e-04,3.254215780475636349e-03,3.335710953623704069e-04,-6.849559647544306443e-04,1.104025943871314239e-03],
    [3.124645606886337955e-04,2.488025820368071182e-05,-1.110169160163334678e-03,-1.041434842039725209e-03,-1.469605512113899431e-04,-8.630552369273115877e-04,3.296176171673723685e-04,-1.238189529554464081e-03,1.638785268154135911e-04,-1.277921691838582305e-03],
    [8.094316259248339864e-04,6.234242317861973044e-05,-5.975928996103658901e-04,-5.382866619853745194e-04,1.228797514267459948e-04,9.992903812873301685e-04,1.408466636386260023e-03,1.513282586181035911e-03,9.511693131157733809e-05,1.430190336864119952e-03],
    [4.080908054167175364e-04,2.511561385108115906e-04,1.267666885828565586e-04,-6.494341718347522950e-06,7.215803103007968709e-04,8.425564221933460945e-04,2.737693522726818035e-05,5.591816029861067499e-04,-5.497175042939450584e-04,2.052725894888684675e-04],
    [3.436030564685439107e-03,-3.022912594891272848e-04,1.818820568985175183e-04,3.689897888663802735e-04,-3.908683248789224826e-04,-1.696727607141094052e-04,2.773074750596419592e-03,2.311847750153995954e-04,-1.217726541052463251e-04,1.005662293942143678e-03],
    [3.812453365572277247e-04,7.954453913640713433e-04,-1.094139860199544673e-03,-1.004376202757633132e-03,9.941929051303626669e-04,8.686610765397092052e-04,6.220610567787894941e-04,6.428002489309948614e-04,1.882987639634219751e-04,4.627478278664901024e-04],
    [3.817958397919534331e-03,1.036911692290292211e-04,-3.507147722398916385e-05,4.541776109506790571e-05,3.200163589120586226e-05,1.601454552898030025e-04,3.500748084882057687e-03,4.520911670326524176e-04,3.439029011799051017e-04,1.299526966468826259e-03],
    [3.795917072316862349e-03,3.386528444969073501e-04,-7.252373842102908565e-04,-7.159702140650009861e-04,7.541072431724817797e-04,1.199531403518140117e-03,2.363974359929565342e-03,1.348323305973112745e-03,-5.441308301842151919e-04,1.884080294896842405e-03],
    [5.607300875269221859e-04,1.771442531991180137e-04,-1.994766807916914606e-03,-1.717816030685467453e-03,8.926002742403678402e-04,1.186529077002936331e-03,8.716434561777750955e-04,8.454597021163070538e-04,-1.054421405452236069e-03,4.132513279076961178e-04],
    [3.376637405344837164e-03,-4.567110214019295435e-05,1.339736018840952027e-03,1.801358811906854113e-03,1.752612696913418918e-04,2.780232056004669538e-04,2.037228998404696026e-03,5.314311266608227007e-05,2.805484867305371390e-05,-3.747184085643503332e-04],
    [2.413397555477703616e-03,-5.111779525516550954e-04,-6.140194884540091640e-04,-4.281957160456128066e-04,-5.347486800610777607e-05,1.328739333136949672e-03,2.092218814055942303e-03,1.891069564252985478e-03,-7.762376587429721054e-04,1.876374413488682627e-03],
    [2.799274673379913494e-03,5.629994709480423990e-04,6.802138267699031236e-04,7.644355720613663172e-04,4.944945003894957343e-04,1.737868463582220840e-03,2.786780040130173910e-03,2.516542153041770313e-03,1.263850604241178316e-03,2.528776576379451052e-03],
    [-5.511157868668168465e-04,1.270959361072208482e-03,-3.519055179645760281e-04,-2.732237574593875400e-04,9.314159554033329437e-04,3.038874185141919159e-04,-6.625875768897616187e-04,2.106642850582269699e-04,1.276725008219667824e-03,-1.211047941384151005e-04],
    [2.641287531702678822e-04,3.707964896250522590e-04,-2.722354746882413626e-04,-3.537205564922591425e-04,2.323034395480700622e-04,3.813615144425836216e-04,8.899143877457523942e-04,4.553689548163911485e-04,7.575697137321542535e-04,6.377502423437721906e-05],
    [3.873355152483223731e-03,1.616966053757731565e-04,-1.407133960352648615e-03,-1.275153836890179559e-03,2.788958589994856700e-04,3.381047991566751214e-04,3.065358178876612973e-03,2.890347007937243994e-04,1.716571462280116599e-04,3.088317527437163426e-04],
    [2.445785893540222949e-03,9.852555673454154242e-04,1.624930984573365127e-04,2.431436161630387495e-04,3.308331558126587774e-04,2.378155236504251108e-05,8.700130322880805138e-04,6.432375113300060681e-04,1.712623134317180348e-03,1.998093152643070324e-03],
    [1.360155375826579320e-03,1.149968136011140412e-03,-4.496752397590738888e-04,-3.416529881817269992e-04,1.314325646947360569e-03,1.090593737496037274e-03,-7.114255297143218444e-05,7.985822862971228824e-04,5.816953269638582436e-04,4.166131125797028069e-04],
    [-7.929977659902347122e-04,9.362174897009249231e-04,-1.747713170268205265e-03,-1.877092937172212574e-03,1.309290010746991468e-03,1.766160244450555193e-03,-3.100166081338313049e-04,1.605179255508789888e-03,4.771078436259431352e-04,7.749491589119796410e-04],
    [2.661165484438276227e-04,1.500488854143159322e-03,9.201596894916603913e-05,-1.114375286087791283e-04,1.197603504225949397e-03,-3.146319578439202855e-04,1.731657541981287539e-04,-1.065878855668314770e-03,1.396722483123526842e-03,-1.100542653226192899e-03],
    [2.229509314509406110e-03,-2.613820686065570120e-04,4.008623691970343659e-04,-2.383229883543313600e-05,-2.114168617303940965e-04,2.060015727753662076e-04,1.634504221388521179e-03,5.874807523838212944e-04,-6.146954477512502567e-05,1.162848841029484733e-03],
    [2.811419193365229541e-03,4.194369078648912019e-04,1.003297505195726723e-04,5.728104255473394314e-05,2.066169631592353799e-04,5.104727929136999636e-04,2.416891372945858228e-03,1.061672445491307305e-03,7.551331940912874843e-04,1.682857171449246569e-03],
    [3.331927441348840439e-03,1.234452515967835546e-03,-7.051060810115997125e-04,-4.277481627780630401e-04,6.146847850113270999e-04,-7.083900824418128562e-04,2.326955324370238477e-03,-9.496128812240037763e-04,1.524477943059886469e-03,-3.462445495892576761e-04],
    [9.698267819349457421e-04,8.960644158729636887e-04,-5.144904140021302552e-05,-1.882305221229571795e-04,8.944272703455139265e-04,4.430347890707415004e-04,6.655119397476688204e-04,2.005269860414075729e-05,7.983185643254079190e-04,-6.319961637686757156e-04],
    [3.120199350882764833e-03,-2.654479844852300268e-04,-4.971448048415695120e-04,4.732537587788383625e-05,-3.602308153143714753e-04,-2.939924164021472737e-04,3.030011835117491208e-03,-1.148338339357616358e-04,1.010236124321235268e-04,2.992172322506037366e-04],
    [2.362853942774543158e-03,-9.985904092485176076e-04,-3.646535699704400875e-04,-7.585398732485153510e-05,-4.534025417560444242e-04,3.465450329702725318e-04,1.453143498595446019e-03,2.184671710291987725e-04,-1.006043587522515315e-03,-5.360999879266130797e-04],
    [3.992784246394047616e-03,-3.290245700826225196e-04,3.459596354939624787e-04,3.713518050023822611e-04,-5.954935110393559325e-05,8.555438055988589478e-04,3.668609922996990663e-03,1.173080054072931418e-03,-4.136688984498962515e-04,8.095359438152953478e-04],
    [3.515737630964087517e-03,1.239151069947832271e-04,2.171279134226767802e-04,1.846142331814390198e-04,6.702274201911129345e-04,1.694713281965337832e-03,2.688403687235417245e-03,1.801851594780797894e-03,-2.681271284795913351e-04,1.195468441609616374e-03],
    [2.355297220411503838e-03,1.169980390609871856e-03,-2.734803643622688626e-04,1.479457005018098724e-04,1.592878461623014382e-03,1.507517169872680260e-03,7.418886172725585974e-04,1.139341336491564091e-03,-7.582335762942296522e-05,6.637930295130657979e-04],
    [-1.352943124031688029e-03,1.212734874131492268e-03,-1.313427646087163248e-04,-2.104520931580172402e-04,8.583270845494735254e-04,5.570351126653360404e-04,-1.076448393681514503e-03,4.679552076260515389e-04,1.851480539767063910e-03,8.622555470434607728e-05],
    [4.026453317466245066e-04,1.164789358624479130e-03,-7.415612048254631872e-04,-1.084943919517849121e-03,1.020761537493156991e-03,4.021943825989568889e-04,-4.783366446155854065e-04,9.602355774737755150e-05,1.109201049887873543e-03,7.116233520340148302e-06],
    [-6.975422318522225308e-05,-8.075317140950180389e-04,-8.612045862307211560e-04,-7.739533421105236882e-04,-8.268022248357856938e-04,-7.038491450727079593e-05,3.543862302951219937e-04,3.158507724901629893e-04,1.989685042957252382e-04,4.636639517175380120e-04],
    [2.545782563764016713e-03,-1.416183892511124743e-04,-7.478745016535606402e-04,-7.759829308926762415e-04,2.476415292344497310e-05,8.347439647133628919e-04,1.972203248982326140e-03,1.458371250313416452e-03,-2.447857487187966191e-04,2.284852867045823136e-03],
    [2.919740999584052778e-03,-1.725340826611209343e-04,4.340778237164821742e-04,1.619911118168897060e-04,-3.712740090350966147e-04,-1.531653051255793454e-04,2.603773917216921537e-03,3.108229861887171013e-04,1.499748988957263650e-04,9.802468912934649697e-04],
    [3.652739019608310534e-03,5.344152587512661801e-04,4.035250844751730689e-04,4.766668089838199218e-04,6.818394761477653693e-04,4.930255338477217966e-04,2.739785338418276265e-03,3.718948397257266169e-04,-1.861845958244895372e-04,5.432519117290151136e-04],
    [-1.068427560245988322e-03,1.288084321487811519e-03,-3.371528137691060965e-04,-7.909825328485731773e-04,1.605678760078239203e-03,1.865103552935007576e-03,-3.921889205717107320e-04,1.574227675494861960e-03,4.604091849686438656e-04,-4.463787116905936251e-05],
    [9.704230072028612345e-04,1.142885387843750556e-03,-3.196628603270112003e-04,-4.455607396970022818e-04,1.215348801929057006e-03,7.585483049007340573e-04,1.066095322779837774e-03,3.650364211434594134e-04,6.838331637676458305e-04,2.290806499454803451e-05],
    [3.848978804220105302e-03,1.887282447986676239e-04,-5.420917677120891832e-04,-5.996975162111708698e-04,-2.608353317766218471e-05,-1.595810592704521012e-04,4.038855049838151016e-03,4.818955911342592249e-05,2.995226645865429528e-04,5.852341842238663197e-04],
    [7.514194272319680342e-04,8.691171308497696658e-05,-5.079040207916324075e-04,-4.659682016845354815e-04,-3.941775386049732068e-05,-1.622533472628851479e-04,1.167704587781849329e-03,-3.253701351080661840e-04,3.845205356234430169e-04,-1.149357149058529131e-03],
    [-6.407370073357996666e-04,-6.788774105522689785e-04,-4.593879125869615226e-04,3.107421167072012768e-04,-1.011812049118840026e-03,-6.523031530946939507e-04,5.114917839033493331e-06,1.676887821046006851e-04,-1.021719771633483191e-04,1.555148881987843557e-03],
    [4.052384636418377437e-04,6.313921918323647060e-04,3.522232329498417949e-04,3.614832262832848157e-04,4.526689491465942026e-04,5.418133307576833251e-04,6.601102567912856033e-04,6.683238362716263474e-04,8.174915818347659648e-04,3.450690271925984732e-04],
    [3.983031435953066773e-04,9.562516502341144664e-04,7.048208160276347783e-04,9.441551479391671175e-04,1.324185373669608786e-03,1.081450905415740505e-03,7.371776792449406682e-04,4.873602709052961301e-04,2.070790089530206307e-04,-6.682425152614604414e-04],
    [2.743749765782558647e-03,1.451830565999471774e-04,-2.782397228649553431e-04,-2.669399375163587621e-04,3.598885022915875487e-04,4.972435710415303283e-04,2.510212049214642291e-03,4.352288237531005770e-04,-1.403448913433807065e-04,1.714604236777557357e-04],
    [2.809303636394072830e-03,2.236957994837469920e-04,4.635774116124215661e-04,-1.555021336458969916e-04,3.122731280499228753e-05,-2.264733493051709272e-04,2.988494071034351971e-03,-2.060881379457542349e-04,6.242665665923202104e-04,1.455247754141767542e-04],
    [3.600527029511389927e-03,1.208008758717597428e-03,-6.140295099810455515e-04,-7.480194215802098102e-04,1.257996003775828549e-03,6.046922725979811787e-04,2.558255095410391991e-03,-2.180568757914770668e-05,5.229649678054562210e-04,-1.067276843216006382e-03],
    [2.452900539701143197e-03,1.113792126101909681e-03,3.397463361426891326e-04,2.338270392914457304e-04,1.343342993001739837e-03,1.317564690117633630e-03,2.297087176700265271e-03,1.055988710381148112e-03,3.757159933494453870e-04,2.411191554130634202e-04],
    [1.327974347133915141e-04,1.170930810619315527e-03,-5.295791360703170888e-04,-4.987997103089861824e-04,1.183704361910121929e-03,1.726848101538139019e-03,8.768779137107989442e-04,1.893652519561160163e-03,1.514285994119026445e-03,1.245143836352288627e-03],
    [1.722417442407465926e-04,-1.285534933773529332e-05,-4.640579285011578827e-04,-1.001536845326652563e-03,-7.070616431755124816e-05,9.011205596573060588e-05,3.379079191085034191e-04,2.827418096761993532e-05,7.842395383544274951e-04,-6.048059602739876400e-04],
    [2.730647786977739595e-03,1.503578012102368359e-03,-9.238476463185867505e-04,-3.075893005025641153e-04,1.437817648944949515e-03,9.137847832849954090e-04,1.396846626968007658e-03,7.935815631227983004e-04,9.784071694422895576e-04,1.133132561190484076e-03],
    [6.750567163786579149e-05,4.806760119285754542e-04,-8.680765422339067157e-04,-9.703319088466144529e-04,8.920890211332339328e-04,1.383955516955711392e-03,5.723547004468918561e-04,1.095675122330027349e-03,2.662890560098026558e-04,-3.618544087015451499e-04],
    [3.018626745372688432e-03,1.364455990589467102e-03,-1.661378703686891990e-03,-1.597401556949020786e-03,1.117606405185307119e-03,1.254098214739331283e-03,2.411833094911157872e-03,1.715412089271557087e-03,1.644256393518509418e-03,2.182281775884606020e-03],
    [-2.323947991692094039e-04,3.335742607932335813e-04,5.814983253075177482e-04,7.212370708500320110e-04,-4.680427506632702341e-05,3.904303890238081088e-04,2.784705239840402886e-05,8.752954764028397045e-04,1.591612507207104503e-03,9.822080809435511633e-04],
    [1.950958049514199630e-03,-1.213951325054473144e-04,7.658678126453269440e-04,9.402507683926151659e-04,-1.752461021776366000e-04,-2.645243952952297940e-04,2.143414646587566211e-03,-2.683964971286167110e-04,1.535164599842410709e-04,-7.835996537602528053e-05],
    [2.375061079435988095e-03,4.901997326079623324e-04,-7.031975293584324374e-04,-6.009070153351574314e-04,7.901226603938363855e-04,8.544377942904271507e-04,1.738009655924574633e-03,6.094219915393599141e-04,-5.198547667364033587e-04,-3.728236344222213999e-04],
    [3.234517187123987433e-03,2.816008414603660267e-04,1.844779364050047003e-03,1.356152783194407557e-03,3.963515975066136043e-04,8.839610158730966220e-04,3.099501198584476286e-03,1.221789560877749661e-03,-1.129533519035051025e-04,9.988152007653445727e-04],
    [-5.573650965497579761e-04,-4.899918332653045803e-04,-2.981991743605650171e-04,-5.317846090268459796e-04,-3.613927193461525080e-04,4.285307307877500214e-04,3.319495575495386044e-04,6.977991387369382025e-04,-7.638295994582020932e-05,4.663547845248300697e-04],
    [2.234073353947168931e-03,-2.366638009917584017e-04,1.981715703350837420e-03,1.948107896317970286e-03,-3.014562434197302497e-04,-6.016072177272486533e-04,2.520789288424885380e-03,-7.100918989924309959e-04,-2.406215433924310397e-04,-4.896555402048078341e-04],
    [-2.625286424310088805e-04,7.240116558056121712e-04,-8.073790994692051125e-04,-7.157771043354340789e-04,1.229865355807865284e-03,2.095754916935262981e-03,-4.707195801385926596e-05,2.152504740368259718e-03,-8.768013252612673791e-05,1.127278019818302819e-03],
    [3.262795605554744995e-03,1.061872228717267294e-03,-1.691287813613164936e-04,-7.811080919611149075e-06,8.946546219228368414e-04,1.273646802298068173e-04,1.792964100734321248e-03,-9.289609416208733381e-05,6.566741394298978522e-04,3.183853730774703606e-04],
    [2.477520103132756224e-03,-2.789051999221892978e-05,6.692986299394038368e-04,7.699319078976487284e-04,4.692289519527319481e-04,1.027513227746514003e-03,1.666707604390691919e-03,1.102540712989351747e-03,-9.025215224531796645e-04,8.944221989226661769e-04],
    [2.090958445666497596e-03,1.437200221334416529e-03,-9.266474927894670626e-04,-9.260455581716169060e-04,1.495933160809932716e-03,1.417397374071037745e-03,1.675436954691379753e-03,1.302387977634759074e-03,1.141974160395619557e-03,9.494214689047884674e-04],
    [-8.258078323032025034e-04,3.595072531574145859e-04,9.638161535307571614e-04,9.280768699675604567e-04,-1.178433505746852923e-04,-6.037989429769003488e-04,-5.709126137089716880e-04,-4.649566960372138527e-04,9.493766289251487616e-04,-2.020634922530148187e-04],
    [3.376899193306498459e-03,9.695125004072414248e-04,3.916828222587823518e-05,3.861760461606827629e-04,8.245849224501417213e-04,6.010179409653095993e-04,2.059898130673119571e-03,5.834927582012667613e-04,1.363826048401600276e-03,7.695825321360483251e-04],
    [2.184857432901084022e-03,8.246525009827931647e-04,-1.126062520847135977e-03,-1.050113756171052294e-03,7.538226063231756070e-04,6.441110964286453962e-04,1.880505411152071571e-03,6.365474883172314883e-04,8.281475459560647514e-04,6.695535970881758090e-04],
    [8.590319671834877133e-04,-6.149252395681236924e-04,-4.507238329066346545e-04,-2.802588968694220780e-05,-5.269857710635086120e-04,2.304665815582941689e-04,-6.851885694563738605e-04,9.170457011260705173e-04,-6.320755027429171297e-04,1.703097131280668398e-03],
    [1.709493105710829764e-04,1.646606247759100456e-03,1.753586828539178033e-04,7.143920034505322862e-05,1.770462276588609428e-03,8.115018707357398667e-04,2.770038308561540634e-04,4.431511541787604700e-05,1.018505117278218882e-03,-5.430511981315081773e-04],
    [2.717538353147649823e-03,-3.321168869484597487e-04,4.410499349143144209e-04,3.461877892205609446e-04,-4.252466791236234403e-04,-3.420879702237097832e-04,2.232888354377682294e-03,-5.886345825012381647e-05,-4.091375133146650349e-04,2.666139508874719693e-04],
    [3.955008314584429127e-03,5.028421123247640541e-04,-1.206316281809719252e-03,-8.543546456529949214e-04,3.957977664533581159e-04,1.658728446405844845e-04,2.519660233632639666e-03,2.785923663877778425e-04,5.378708133891082089e-04,9.974522729372476901e-04],
    [1.356821679218811591e-04,8.153509027207710234e-04,2.459461118325134438e-04,-2.778965727660938551e-04,4.462354966920681842e-04,3.749465717535578808e-04,5.290417625444993922e-04,5.738490485945864448e-04,1.096192083859555324e-03,1.923575081594438197e-04],
    [1.952976342359093479e-03,4.702526864221486642e-04,-4.854835893405521491e-04,-1.455932078149974832e-04,8.670125865762223945e-05,9.609769484892907124e-05,9.512692822200306863e-04,6.215338094470485193e-04,9.506294847559839788e-04,1.323755682866345528e-03],
    [-7.663500010934834374e-04,1.650732098216313578e-03,9.000226282460125824e-05,-1.882405705409364357e-04,1.037193983986009265e-03,4.674391344564946525e-04,-8.186234033821061318e-04,5.110126340526293352e-04,2.434113284278768830e-03,4.878805360145062157e-04],
    [2.924605039665481554e-04,1.269257722562215336e-03,9.924053245095835075e-04,8.817878199328334134e-04,1.295185877013450056e-03,1.076514382358237723e-03,5.502561938046661612e-04,6.861895987695749641e-04,1.449537937377144529e-03,-3.523089626052305673e-04],
    [2.121465527942846454e-03,2.359225469344666923e-04,5.523433056919392712e-04,7.862706484863640462e-04,2.968145270217093759e-04,7.924299542864731783e-04,1.522540576716176946e-03,9.250940278197704704e-04,7.624123002760397824e-04,7.561070678744252673e-04],
    [3.752496702910005071e-03,-6.125477320342727870e-04,-3.752295128611320162e-04,-4.129879631554609536e-04,-2.807589862296484958e-04,2.987094397299908935e-04,3.638652554363384223e-03,4.395039173913826915e-04,-9.298100841425666020e-04,4.344016380366497762e-04],
    [-9.839149473874686449e-05,8.866116509098955758e-04,6.103060827889239580e-04,5.927213039099805611e-04,6.178428506930186978e-04,3.561791464800605905e-04,4.998940310865453065e-04,2.608947355179103708e-04,1.161438311279765299e-03,-1.278849534183778137e-04],
    [2.071764346366907622e-03,1.517658650905643909e-03,-1.380388233459997724e-04,-1.851328891951886332e-04,1.572369153362211712e-03,1.670997209675700434e-03,1.658057231819301926e-03,1.653764518879690792e-03,1.259875359299837422e-03,1.220322781725193722e-03],
    [3.466988785660353890e-03,2.307936423512068637e-04,-7.431090372246550429e-04,-1.186924082593612513e-03,4.980959356342615219e-04,1.162750054682163466e-03,2.482809795548122055e-03,1.314819928161210490e-03,1.525833338465965255e-04,1.245831983558989440e-03],
    [2.757236233991906295e-03,9.843585324939903725e-04,6.368711025376022237e-04,5.250855715200149123e-04,7.173506804475840827e-04,8.112183693114846574e-04,2.026752071042439880e-03,1.335231533745122193e-03,1.013380842969072073e-03,2.036806421242915929e-03],
    [3.671276916656843973e-03,-3.107228068175049609e-05,-5.207375069864393332e-04,-6.112023283769374383e-04,4.566400742093419240e-04,1.614377615401507487e-03,2.544160868474662583e-03,1.825562066409541035e-03,-2.522708076887799212e-04,1.297310997012733743e-03],
    [-3.846798462988923554e-05,-3.154328797026310915e-04,-1.554290655338750118e-03,-1.632847739383555237e-03,-1.323544009909053841e-04,5.902789302021350069e-04,9.067566040591774510e-04,7.430130664057963850e-04,-7.278063894792594492e-05,1.491661145183195247e-04],
    [2.570515786263223145e-03,7.007478311770055229e-04,6.628888232239323411e-05,2.065616684584196288e-04,-2.510213040470733132e-05,-6.394825191376573691e-04,1.616743102063757315e-03,-3.050517128330438167e-04,1.624905241569612677e-03,3.426269814620975292e-04],
    [1.781572491353964824e-03,-4.069788813337623778e-04,9.243814420873185198e-04,8.134625527481034041e-04,-4.428868682564003991e-04,2.904967170010744034e-04,1.561026116915943587e-03,7.451323272794224423e-04,2.085990240400083869e-04,8.571180427567908671e-04],
    [2.686253678552621635e-03,6.409140997522619213e-04,-6.324704104565592516e-04,-9.295845575081327673e-04,7.804733025540970710e-04,9.976128035863269725e-04,2.024386486537141719e-03,1.063422116829236888e-03,5.309996667843125406e-04,7.144965172773218992e-04],
    [2.906004142597188623e-03,-3.057191936278064339e-05,7.418315134346534960e-04,1.593587101752313810e-04,1.316273846318860932e-05,-1.148410444907634501e-05,2.817660076930692328e-03,4.086352867299154523e-05,-1.766552586821155859e-04,4.195248131577087062e-04],
    [3.323000966270531036e-03,2.059214624650567511e-04,2.116544133306097323e-04,5.015251307025402148e-04,6.183330222914617169e-05,-2.888830299247564445e-04,2.186947357967872641e-03,-2.033057795765469584e-04,4.831234460800008887e-05,6.236043696657431537e-04],
    [-6.838767097173321409e-04,-1.619738066601130374e-05,4.198648388870023342e-04,2.670560657605486983e-04,-1.912784627325378819e-04,-4.755123919529985780e-04,-2.244366986774243031e-05,-6.398768489563272724e-04,3.283651724179807220e-04,-1.198208622947069014e-03],
    [4.425103087588937514e-03,-9.350444859455896499e-04,3.412831096245967860e-04,4.979119756918577895e-04,-5.527099011363475860e-04,3.793613260282247104e-05,3.380538945697306261e-03,1.720133793418467745e-04,-1.203437543822036574e-03,5.305130193422826932e-04],
    [-1.267003125749260883e-03,1.132421032486702122e-03,6.244009947318600318e-04,6.587166475370256815e-04,6.900938829748040799e-04,4.416758061414323644e-05,-9.657322226545801734e-04,3.907042217329362164e-06,1.453260854651980318e-03,-1.351302033097318857e-04],
    [4.305477614236837870e-03,1.255415088400133094e-03,-6.033247513988993990e-04,-8.959829858648873675e-04,1.265888164891925370e-03,1.356409414594564452e-03,3.469556057712517433e-03,1.318441208230779031e-03,9.436610431803848760e-04,5.669670094913095747e-04],
    [2.517728978426397521e-03,-4.287714515956864559e-04,-7.260689738298320558e-04,-9.225909984809368622e-04,-2.044435625951643103e-04,9.060735217564772938e-04,1.994759901677407247e-03,1.660296689647411568e-03,-3.797995834500003903e-04,2.349374387044312826e-03],
    [2.000664528601815619e-03,4.358937000682600580e-04,-5.581653553577941413e-05,-2.073927131851660639e-05,8.694591365013935196e-05,6.634126080697866855e-05,1.849510527769586236e-03,4.836066678099606281e-04,9.021186636468488855e-04,1.123660842861478812e-03],
    [1.350856606364404322e-03,8.462944004010184785e-04,-8.778101380488370100e-05,-4.934541159698649457e-04,8.736367775866194516e-04,5.593368468321581206e-04,7.401170822776328019e-05,5.552668266291347233e-04,-1.631186580922455666e-04,6.423291833714883181e-04],
    [2.244223562939887031e-03,8.302395692477038559e-04,1.118147909298196824e-04,5.243092402646112502e-05,9.620880101295834191e-04,1.374529567225647080e-03,1.612020580453709653e-03,1.696632850698263353e-03,5.407510873597040114e-04,2.088898621281995525e-03],
    [4.647010601884282244e-04,6.482640014477118089e-04,4.126338848478816297e-04,3.202376806987997527e-04,1.039754731650713044e-03,1.645067860274352462e-03,9.622295764455359368e-04,1.777484158976250315e-03,-2.974025805877548436e-04,1.115883364683765630e-03],
    [3.020358761082541071e-03,2.020309584967913111e-04,2.311370592526731818e-04,2.184201552585723959e-04,1.885017125320885242e-04,2.881472197705274983e-05,2.396649846681437896e-03,-1.222700949165582184e-05,4.617313584387903281e-05,-1.594738529403076665e-04],
    [1.165700122958793737e-03,1.132691526181665853e-03,-3.668859010037415678e-04,-1.940494670372610090e-04,1.523699705573998420e-03,1.749179971339087951e-03,1.102437185329898078e-03,1.584072962932627686e-03,4.890483903611086286e-04,1.347025031149757211e-03],
    [2.229906821694772369e-03,-2.814362180780301693e-04,1.082788689533253955e-03,1.298370462912237485e-03,-4.291142956352667266e-04,-6.741819963796851813e-04,8.268451387868901723e-04,-5.029105658000423106e-04,-2.228792451694946151e-04,4.707606485638213267e-04],
    [2.518309738051131320e-03,2.229536518874577697e-04,-9.056845358651726807e-05,-3.952970901412947852e-04,-1.289219267914586760e-04,-2.234147474091516988e-04,1.757852169090018965e-03,2.033276028458378922e-04,6.260845211866647398e-04,9.976460582954490165e-04],
    [1.605952820539964434e-03,4.405870825919788172e-04,-7.899323326596326134e-04,-1.105998648594628923e-03,4.551920864439837409e-04,6.585016368457962885e-04,1.089490367109083833e-03,9.205230509445348546e-04,3.241218684881092514e-04,1.172198842997889756e-03],
    [2.028502571320298098e-03,5.288175336270799177e-04,2.791865577401079568e-04,1.756765152435015270e-04,6.299868367577436288e-04,1.038571418435216449e-03,7.103641566732732089e-04,1.483828848484815364e-03,9.016971884221327649e-05,2.052252107745712595e-03],
    [5.379041146938756722e-04,6.304910001667905772e-04,-3.780717695969373991e-04,-8.504648847244630438e-06,5.247377152824800025e-04,3.880459497101349317e-05,-4.882845515087318742e-04,-7.113420451660239772e-05,2.996337990409634906e-04,5.909087427642747698e-05],
    [2.393408453790782809e-03,-3.379482945731841748e-04,1.080439949184108767e-04,2.104205736160761687e-04,2.413114965236956338e-04,1.029565181233113450e-03,1.616725021145092251e-03,8.895237594872553409e-04,-5.386804940871600059e-04,1.094658311458429761e-05],
    [1.710317032998880148e-03,1.671006293571608049e-03,2.555572316841619334e-04,9.613028978334237432e-04,2.006716674988044593e-03,1.974092734437495403e-03,7.668022740372265264e-04,1.680959638237409636e-03,8.625545415749031643e-04,8.024873924697929414e-04],
    [1.987361149352568062e-03,1.216381084592733962e-03,-4.848688111055540393e-04,-2.557804507849579666e-04,1.525321084319490681e-03,2.042008612639681711e-03,1.458250448627847239e-03,2.242956939922440603e-03,5.626043036650451180e-04,2.031802131094950954e-03],
    [-4.777704364655269978e-04,-1.704822473634076826e-04,-2.214043656309858251e-04,-4.896580688034347581e-04,-2.740887080036671468e-06,2.787022241717713447e-04,1.563139803692769356e-04,6.040386986075498401e-05,6.334144500548622510e-05,-1.097333884297168726e-03],
    [3.387220778511312088e-03,4.511115482730607119e-04,5.956096505576138379e-04,1.187583536948553413e-03,1.070995232042664096e-04,-7.002131528862495444e-04,2.187369771134523196e-03,-8.237041694918554192e-04,4.909638688632344747e-04,-3.490279052945729934e-04],
    [1.171480573712175774e-03,-4.374190414555266006e-04,-6.868397180231977173e-04,-1.108521388492223099e-03,-9.582729175469212844e-04,-1.326022196004823751e-03,1.733478581355367594e-03,-1.199612624695507203e-03,3.176670097065745668e-04,-8.740912290399407850e-04],
    [2.678962654940498112e-03,7.240919538020884746e-04,3.749110540690743748e-04,4.683101984451538036e-04,6.869938304569949469e-04,3.626135337077789457e-04,2.092647168386427628e-03,4.929731137697350180e-04,-1.122368576295261131e-04,1.394916549766180231e-03],
    [-3.942477989716909668e-04,3.735902178430079343e-04,2.061552679398618605e-04,5.666781024141864364e-04,1.478691516470725476e-04,4.094087622211040989e-05,-8.075533387483996902e-04,2.973638535355837696e-04,3.978766533913419778e-04,7.036546188285231016e-04],
    [2.527864412145788744e-03,-7.247542809919624253e-04,-1.400526379957843699e-04,-3.827529095637876070e-04,-7.980321340397227405e-04,-3.551642564482534103e-04,1.497022793422649609e-03,2.222128071483350190e-04,-3.762864445503905672e-04,1.255738354993255227e-03],
    [6.101615462324161930e-04,8.055085161208948557e-04,-7.570722519769063725e-04,-8.051375538122472952e-04,9.887610297392894834e-04,2.769699202068059475e-04,6.300604908343088477e-04,-3.641287535224801649e-04,2.914421720380728871e-05,-9.705487362202971880e-04],
    [2.123924136359396555e-03,4.637994469052481418e-04,3.304750626165237786e-04,3.240709059766367348e-04,2.779512003039899971e-04,1.219422078969103183e-04,1.972335487807858750e-03,2.440301372638236863e-04,8.268482804558571417e-04,6.504451697415431248e-04],
    [-1.790193970218630732e-03,5.870140269758166145e-04,7.272165731164946219e-04,9.555295941397403282e-04,2.095678257381714373e-04,7.689556704066006416e-06,-1.548044667076664896e-03,9.577021813130994355e-05,1.022135700812948659e-03,-1.972453248729276042e-04],
    [2.650765928718218888e-03,8.035103140744547130e-04,6.872992311533582211e-04,7.527835423499888452e-04,4.792008636059211430e-04,7.501517511748653734e-05,2.175608642543066813e-03,1.851432018361278070e-04,1.043032528404791220e-03,5.602924478161010365e-04],
    [2.796075657661737865e-03,8.519209155506919434e-04,1.518069020610292698e-04,-1.312258982367642160e-04,1.104708107294662123e-03,1.200035718149623006e-03,1.203568180944730465e-03,9.970264524532704113e-04,6.201315582586981691e-04,8.292954613849106045e-04],
    [1.284195485067916517e-03,2.072193999441312214e-04,6.293016033376365491e-04,6.844074306911317879e-04,7.028850824023990217e-04,2.046151929157814450e-03,3.274157019248888812e-04,2.239725782675206465e-03,2.471155707186815779e-04,1.276009295959355805e-03],
    [2.235928389921150797e-03,9.336015603681475494e-04,6.114670893060410563e-04,-7.051728815554954082e-05,6.234402601268364741e-04,6.454199374967289514e-04,2.187241402379932250e-03,7.785227797385740802e-04,1.625349072843673692e-03,4.713052680821425188e-04],
    [2.111572688201896874e-03,4.516944044924439770e-04,-8.026461412702046942e-04,-9.339390138531093646e-04,8.328327970825257810e-04,9.695610006019023943e-04,1.720248842665423944e-03,7.384829166834485986e-04,1.336620974040449487e-04,4.306785851252233240e-04],
    [1.692697081748241808e-03,4.536869310340430669e-04,-1.999413628626306786e-04,-4.901342829142258398e-05,1.267505543270451779e-03,2.180724090272729166e-03,7.087999902273937631e-04,1.868202512649787218e-03,-2.111947055039746827e-04,5.199112721557649008e-04],
    [1.702351144850901624e-03,1.146661236225494235e-03,6.754281757659606495e-04,6.594617865065360808e-04,1.312181526861309292e-03,1.186982772362455514e-03,1.118196614092752030e-03,1.110319257719305118e-03,2.668894446546284647e-04,1.100433901397752500e-03],
    [1.605576874357780024e-03,1.552665066748987579e-03,8.142319718429035739e-04,9.598662770121326078e-04,1.686757585493540686e-03,1.498477784461534372e-03,5.383352235224179430e-04,1.236428404110919126e-03,1.122287244627232774e-03,7.811493296895793189e-04],
    [3.548681336343602853e-03,9.949693194104501908e-04,4.029871082501820887e-04,3.320414562564220082e-04,1.402076860504539732e-03,1.631353869337608727e-03,3.187591308138704258e-03,1.473027171388927373e-03,7.837636778059780217e-05,6.274739531580159763e-04],
    [2.457438061095922315e-03,6.771340322073805601e-04,-5.101287057585180253e-04,-8.880751596361425183e-04,8.241679177697745643e-04,9.484673097663083455e-04,2.149148759704577923e-03,8.709633291888372025e-04,4.130359920100617338e-04,4.250375284409569710e-04],
    [2.838341819521614500e-03,2.073758396975312196e-03,9.349965740687536382e-05,-1.345720798374808495e-04,1.713319518069508123e-03,7.468220432755555156e-04,2.125894956392607171e-03,7.262445068547774630e-04,1.483161562020182331e-03,1.788215396333575017e-03],
    [-1.950599697100026755e-04,8.189269997832712396e-04,1.835205516247675160e-04,3.514604711341950244e-04,9.716514486530456211e-04,4.865583772577774255e-04,2.129614163359239978e-04,-2.497797231562714050e-04,4.724799129041007168e-04,-1.821137865116105505e-03],
    [1.785885230939634246e-03,1.781807556153457703e-04,1.235443621022452344e-03,9.314937589779124540e-04,3.263155317449350666e-04,7.570913380914535886e-04,1.403870895015940255e-03,9.801452245581305286e-04,-2.509263517958784553e-04,1.052142314583669929e-03],
    [9.341026961465385492e-04,2.448095925840117746e-04,2.460295018042268455e-04,2.195881963227023159e-04,2.253574784561976254e-04,3.575626672574031017e-04,2.465366636925558279e-04,6.052349672760223669e-04,1.290034741070554926e-04,9.957236378518490375e-04],
    [2.078496685482887889e-03,-3.481458682071972245e-04,-5.209125300323993752e-04,-5.207771700565799744e-04,5.775058758977357105e-05,8.531393157605269293e-04,1.132040762370576563e-03,9.751458256709470479e-04,-3.090606686521840218e-04,7.281723390436600296e-04],
    [1.162867914320356993e-03,6.699909780139453024e-04,-8.985498038358296106e-04,-1.251156861191817307e-03,6.012589705538974724e-04,7.220801241319352521e-04,1.655208597380576239e-03,7.284895259307754087e-04,1.202334620681209335e-03,5.192369944075524634e-04],
    [1.306169161837386411e-03,1.989651819941694669e-04,1.014946947798932731e-03,9.422247518897679730e-04,2.986584223152275873e-04,5.191506163623747826e-04,2.359789390229371218e-04,5.766167658286972886e-04,3.844910870092362845e-04,7.159338884013145138e-04],
    [1.918537295334374468e-03,-4.378262276060357360e-04,7.715183610589716832e-04,8.932143202347484715e-04,-6.167511281392312316e-04,-5.068179017823104017e-04,1.187228247145293188e-03,-3.409112442397890948e-04,2.865709481871854406e-04,6.468527473697345466e-05],
    [1.558109212523536326e-03,-6.399073439546219431e-04,1.220664116827051499e-03,1.536188180579438085e-03,-8.407158462627464194e-04,-1.052778909997776659e-03,7.238799637681449066e-04,-7.693018148897611506e-04,-8.973586706598577368e-04,2.094755599091468611e-04],
    [3.305922980125616719e-03,-2.402818273346731405e-04,-3.127106664848382993e-04,1.760789437028582123e-04,-9.305544044338179461e-05,3.831255117165395865e-04,2.447621448648039811e-03,6.904489773408331284e-04,-1.253917570650657542e-04,1.314259304657538693e-03],
    [2.413341600572140033e-03,2.424025774826536164e-04,-3.814118989886271498e-04,-3.888107235705587882e-04,5.614186842573028885e-04,9.912541769449016629e-04,1.515097527900798350e-03,1.190824435229591348e-03,-5.521719761514486905e-04,1.217999424543042422e-03],
    [1.376933321680487259e-03,7.980012018330210049e-04,5.032192499100752265e-04,9.490143819511402895e-05,1.071082295407328484e-03,9.882177759482102010e-04,8.844781990583753173e-04,5.889189845042090742e-04,2.200413366784704247e-04,-2.196611447767729910e-04],
    [1.547794191478759837e-03,4.772183724496471434e-04,-8.436545075822602909e-05,5.057378770315878970e-04,7.103339943075204915e-04,8.821148988439370293e-04,7.387717138774726978e-04,9.048864373275557161e-04,-1.331622269039740543e-04,1.042521605422659517e-03],
    [1.432911003601718353e-03,1.230016638606685336e-03,-2.247463612208605208e-04,3.169594304668513045e-04,1.430442286623059573e-03,1.428133181015792900e-03,3.170800705233210730e-06,1.248292340586670433e-03,8.548248588863097434e-04,9.602078859874694020e-04],
    [3.077631091597575388e-03,-7.220379983374009469e-04,2.323126195256747413e-03,2.231698298324675568e-03,-7.991235551337496235e-04,-5.884183418168200232e-04,3.076408408100120197e-03,-3.529687304619586602e-04,-1.267658981720068043e-04,-9.516192857496254699e-05],
    [1.478859827452524370e-03,6.446619418162507879e-04,-7.054400027032124319e-04,-6.702012145024652040e-04,6.604531462067588041e-04,9.056291532231156450e-04,7.897908387146291729e-04,1.292133656650230715e-03,1.478753173591621460e-04,1.938830183314710093e-03],
    [2.696779218657630473e-03,1.320458011580191498e-03,5.638797709068511587e-05,-1.493207601600842795e-04,1.383851379207057209e-03,1.140295156398321531e-03,2.477416510291694830e-03,8.352194469227611695e-04,9.963366673395766208e-04,1.929388561067034067e-04],
    [2.791808643681973397e-03,6.277530535486742754e-04,5.081464210151679425e-04,7.234772419448202291e-04,7.828322543879511495e-04,1.015933827534726405e-03,2.494319362244877807e-03,1.197211773164165828e-03,1.173042586018326294e-04,1.607540833081481588e-03],
    [2.719484405579967925e-03,6.920875512630707575e-04,3.446365353890411504e-04,-4.997090162095863626e-05,5.041905701508180059e-04,7.372294700671366352e-04,2.591361477234273725e-03,1.263952778345329639e-03,6.497998633863137814e-04,2.046311196506172755e-03]])
    
    logging.basicConfig(level=logging.DEBUG)
    
    # features = fakefeatures
    features = realfeatures
    
    clusters, cdata, tree = cluster(features)
    print [len(c) for c in clusters]
    # print len(unmatched)
    
    if plot:
        import pylab as pl
        from mpl_toolkits.mplot3d import Axes3D
        
        ax = Axes3D(pl.figure())
        colors = ['k','b','g','r','m','y']
        for (i,c) in enumerate(clusters):
            d = features[c]
            if len(d) == 0: continue
            ax.scatter(d[:,0],d[:,1],d[:,2],c=colors[i])
        
        # d = features[unmatched]
        # ax.scatter(d[:,0],d[:,1],d[:,2],c='k')
        
        pl.figure()
        
        nf = features.shape[1]
        for x in xrange(nf):
            for y in xrange(nf):
                if x > y:
                    pl.subplot(nf,nf,x+y*nf+1)
                    for (i, c) in enumerate(clusters):
                        d = features[c]
                        if len(d) == 0: continue
                        pl.scatter(d[:,x], d[:,y], c=colors[i], s=10, alpha=0.5, edgecolors=None)
                        # pl.scatter(features[:,x], features[:,y], s=1)
                    # pl.gca().set_axis_off()
                    pl.gca().set_xticks([])
                    pl.gca().set_yticks([])
                    b = 1/8.
                    xr = features[:,x].max() - features[:,x].min()
                    pl.xlim(features[:,x].min()-xr*b, features[:,x].max()+xr*b)
                    yr = features[:,y].max() - features[:,y].min()
                    pl.ylim(features[:,y].min()-yr*b, features[:,y].max()+yr*b)
        
        pl.figure()
        pl.imshow(tree, interpolation='nearest')
        pl.figure()
        pl.imshow(cdata, interpolation='nearest')
        pl.show()
    return # don't do real data for now

if __name__ == '__main__':
    test_cluster(True)